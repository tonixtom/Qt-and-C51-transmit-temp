C51 COMPILER V9.56.0.0   MAIN                                                              02/02/2020 13:59:10 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: G:\softs\kile_v5_S\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listi
                    -ngs\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*******************************************************************************
   2          *                 
   3          *                            ÆÕÖÐ¿Æ¼¼
   4          --------------------------------------------------------------------------------
   5          * Êµ Ñé Ãû     : 18B20ÎÂ¶ÈÏÔÊ¾ÊÔÑé
   6          * ÊµÑéËµÃ÷       : LCD1602ÏÔÊ¾ÎÂ¶ÈÖµ¡£
   7          * Á¬½Ó·½Ê½       : ¼ûÁ¬½ÓÍ¼
   8          * ×¢    Òâ     : 
   9          *******************************************************************************/
  10          
  11          #include<reg51.h>
  12          #include"lcd.h"
  13          #include"temp.h"
  14          void LcdDisplay(int);
  15          unsigned char TEMP[7] = "+000.00";
  16          
  17          //--ÉùÃ÷È«¾Öº¯Êý--//
  18          void UsartConfiguration();
  19          void Delay10ms(unsigned int c);   //Îó²î 0us
  20          
  21          /*******************************************************************************
  22          * º¯ÊýÃû         : main
  23          * º¯Êý¹¦ÄÜ       : Ö÷º¯Êý
  24          * ÊäÈë           : ÎÞ
  25          * Êä³ö           : ÎÞ
  26          *******************************************************************************/
  27          
  28          void main()
  29          {
  30   1        unsigned char i;
  31   1        LcdInit();       //³õÊ¼»¯LCD1602
  32   1        LcdWriteCom(0x88);  //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
  33   1        LcdWriteData('C'); 
  34   1        UsartConfiguration();
  35   1        while(1)
  36   1        {
  37   2          LcdDisplay(Ds18b20ReadTemp());
  38   2      //    Delay1ms(1000);//1sÖÓË¢Ò»´Î
  39   2          
  40   2          for(i=0; i<7; i++)
  41   2          {
  42   3            SBUF = TEMP[i];   //½«Òª·¢ËÍµÄÊý¾Ý·ÅÈëµ½·¢ËÍ¼Ä´æÆ÷
  43   3            while(!TI);     //µÈ´ý·¢ËÍÊý¾ÝÍê³É
  44   3            TI=0;       //Çå³ý·¢ËÍÍê³É±êÖ¾Î»
  45   3          }
  46   2          Delay10ms(50);      //ÑÓÊ±Ò»ÏÂÔÙ·¢
  47   2        }
  48   1      }
  49          
  50          /*******************************************************************************
  51          * º¯ÊýÃû         : LcdDisplay()
  52          * º¯Êý¹¦ÄÜ       : LCDÏÔÊ¾¶ÁÈ¡µ½µÄÎÂ¶È
  53          * ÊäÈë           : v
  54          * Êä³ö           : ÎÞ
C51 COMPILER V9.56.0.0   MAIN                                                              02/02/2020 13:59:10 PAGE 2   

  55          *******************************************************************************/
  56          
  57          void LcdDisplay(int temp)    //lcdÏÔÊ¾
  58          {
  59   1          
  60   1          unsigned char datas[5] = {0, 0, 0, 0, 0}; //¶¨ÒåÊý×é
  61   1        float tp;  
  62   1        if(temp< 0)       //µ±ÎÂ¶ÈÖµÎª¸ºÊý
  63   1          {
  64   2            LcdWriteCom(0x80);    //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
  65   2            LcdWriteData('-');      //ÏÔÊ¾¸º
  66   2            TEMP[0]='-';
  67   2          //ÒòÎª¶ÁÈ¡µÄÎÂ¶ÈÊÇÊµ¼ÊÎÂ¶ÈµÄ²¹Âë£¬ËùÒÔ¼õ1£¬ÔÙÈ¡·´Çó³öÔ­Âë
  68   2          temp=temp-1;
  69   2          temp=~temp;
  70   2          tp=temp;
  71   2          temp=tp*0.0625*100+0.5; 
  72   2          //ÁôÁ½¸öÐ¡Êýµã¾Í*100£¬+0.5ÊÇËÄÉáÎåÈë£¬ÒòÎªCÓïÑÔ¸¡µãÊý×ª»»ÎªÕûÐÍµÄÊ±ºò°ÑÐ¡Êýµã
  73   2          //ºóÃæµÄÊý×Ô¶¯È¥µô£¬²»¹ÜÊÇ·ñ´óÓÚ0.5£¬¶ø+0.5Ö®ºó´óÓÚ0.5µÄ¾ÍÊÇ½ø1ÁË£¬Ð¡ÓÚ0.5µÄ¾Í
  74   2          //ËãÓÉÏ0.5£¬»¹ÊÇÔÚÐ¡ÊýµãºóÃæ¡£
  75   2       
  76   2          }
  77   1        else
  78   1          {     
  79   2            LcdWriteCom(0x80);    //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
  80   2            LcdWriteData('+');    //ÏÔÊ¾Õý
  81   2            TEMP[0]='+';
  82   2          tp=temp;//ÒòÎªÊý¾Ý´¦ÀíÓÐÐ¡ÊýµãËùÒÔ½«ÎÂ¶È¸³¸øÒ»¸ö¸¡µãÐÍ±äÁ¿
  83   2          //Èç¹ûÎÂ¶ÈÊÇÕýµÄÄÇÃ´£¬ÄÇÃ´ÕýÊýµÄÔ­Âë¾ÍÊÇ²¹ÂëËü±¾Éí
  84   2          temp=tp*0.0625*100+0.5; 
  85   2          //ÁôÁ½¸öÐ¡Êýµã¾Í*100£¬+0.5ÊÇËÄÉáÎåÈë£¬ÒòÎªCÓïÑÔ¸¡µãÊý×ª»»ÎªÕûÐÍµÄÊ±ºò°ÑÐ¡Êýµã
  86   2          //ºóÃæµÄÊý×Ô¶¯È¥µô£¬²»¹ÜÊÇ·ñ´óÓÚ0.5£¬¶ø+0.5Ö®ºó´óÓÚ0.5µÄ¾ÍÊÇ½ø1ÁË£¬Ð¡ÓÚ0.5µÄ¾Í
  87   2          //Ëã¼ÓÉÏ0.5£¬»¹ÊÇÔÚÐ¡ÊýµãºóÃæ¡£
  88   2        }
  89   1        datas[0] = temp / 10000;
  90   1        datas[1] = temp % 10000 / 1000;
  91   1        datas[2] = temp % 1000 / 100;
  92   1        datas[3] = temp % 100 / 10;
  93   1        datas[4] = temp % 10;
  94   1        TEMP[1]='0'+datas[0];
  95   1        TEMP[2]='0'+datas[1];
  96   1        TEMP[3]='0'+datas[2];
  97   1        TEMP[5]='0'+datas[3];
  98   1        TEMP[6]='0'+datas[4];
  99   1        LcdWriteCom(0x82);      //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 100   1        LcdWriteData('0'+datas[0]); //°ÙÎ» 
 101   1      
 102   1        
 103   1        LcdWriteCom(0x83);     //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 104   1        LcdWriteData('0'+datas[1]); //Ê®Î»
 105   1      
 106   1        LcdWriteCom(0x84);    //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 107   1        LcdWriteData('0'+datas[2]); //¸öÎ» 
 108   1      
 109   1        LcdWriteCom(0x85);    //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 110   1        LcdWriteData('.');    //ÏÔÊ¾ ¡®.¡¯
 111   1      
 112   1        LcdWriteCom(0x86);     //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 113   1        LcdWriteData('0'+datas[3]); //ÏÔÊ¾Ð¡Êýµã  
 114   1      
 115   1        LcdWriteCom(0x87);     //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 116   1        LcdWriteData('0'+datas[4]); //ÏÔÊ¾Ð¡Êýµã  
C51 COMPILER V9.56.0.0   MAIN                                                              02/02/2020 13:59:10 PAGE 3   

 117   1      }
 118          
 119          
 120          /*******************************************************************************
 121          * º¯ Êý Ãû         :UsartConfiguration()
 122          * º¯Êý¹¦ÄÜ       :ÉèÖÃ´®¿Ú
 123          * Êä    Èë         : ÎÞ
 124          * Êä    ³ö         : ÎÞ
 125          *******************************************************************************/
 126          
 127          void UsartConfiguration()
 128          {
 129   1        SCON=0X50;      //ÉèÖÃÎª¹¤×÷·½Ê½1
 130   1        TMOD=0X20;      //ÉèÖÃ¼ÆÊýÆ÷¹¤×÷·½Ê½2
 131   1        PCON=0X80;      //²¨ÌØÂÊ¼Ó±¶
 132   1        TH1=0XF3;       //¼ÆÊýÆ÷³õÊ¼ÖµÉèÖÃ£¬×¢Òâ²¨ÌØÂÊÊÇ4800µÄ
 133   1        TL1=0XF3;
 134   1      //  ES=1;           //´ò¿ª½ÓÊÕÖÐ¶Ï
 135   1      //  EA=1;           //´ò¿ª×ÜÖÐ¶Ï
 136   1        TR1=1;              //´ò¿ª¼ÆÊýÆ÷
 137   1      }
 138          
 139          /*******************************************************************************
 140          * º¯ Êý Ãû         : Delay10ms
 141          * º¯Êý¹¦ÄÜ       : ÑÓÊ±º¯Êý£¬ÑÓÊ±10ms
 142          * Êä    Èë         : ÎÞ
 143          * Êä    ³ö         : ÎÞ
 144          *******************************************************************************/
 145          
 146          void Delay10ms(unsigned int c)   //Îó²î 0us
 147          {
 148   1          unsigned char a, b;
 149   1      
 150   1        //--cÒÑ¾­ÔÚ´«µÝ¹ýÀ´µÄÊ±ºòÒÑ¾­¸³ÖµÁË£¬ËùÒÔÔÚforÓï¾äµÚÒ»¾ä¾Í²»ÓÃ¸³ÖµÁË--//
 151   1          for (;c>0;c--)
 152   1        {
 153   2          for (b=38;b>0;b--)
 154   2          {
 155   3            for (a=130;a>0;a--);
 156   3          }          
 157   2        }       
 158   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    425    ----
   CONSTANT SIZE    =      5    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
